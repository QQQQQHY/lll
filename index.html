// 拖放功能
function enableDragAndDrop() {
    const linksContainer = document.getElementById('links');

    linksContainer.addEventListener('dragstart', function (e) {
        if (e.target.classList.contains('link-item')) {
            e.target.classList.add('dragging');
        }
    });

    linksContainer.addEventListener('dragover', function (e) {
        e.preventDefault();
        const draggingItem = linksContainer.querySelector('.dragging');
        const siblings = [...linksContainer.querySelectorAll('.link-item:not(.dragging)')];
        const nextSibling = siblings.find(sibling => e.clientY <= sibling.offsetTop + sibling.offsetHeight / 2);
        linksContainer.insertBefore(draggingItem, nextSibling);
    });

    linksContainer.addEventListener('dragend', function (e) {
        if (e.target.classList.contains('link-item')) {
            e.target.classList.remove('dragging');
            updateLinksOrder();
        }
    });
}

// 编辑链接
function enableEditLinks() {
    document.getElementById('links').addEventListener('click', function (e) {
        if (e.target.classList.contains('edit-icon')) {
            const linkItem = e.target.closest('.link-item');
            const linkButton = linkItem.querySelector('.link-button');
            const name = linkButton.textContent;
            const url = linkButton.href;

            // 弹出模态框
            document.getElementById('link-name').value = name;
            document.getElementById('link-url').value = url;
            document.getElementById('modal').style.display = 'flex';

            // 更新链接
            document.getElementById('modal-submit').onclick = function () {
                const newName = document.getElementById('link-name').value;
                const newUrl = document.getElementById('link-url').value;

                if (newName && newUrl) {
                    linkButton.textContent = newName;
                    linkButton.href = newUrl;
                    updateLinksOrder();
                    document.getElementById('modal').style.display = 'none';
                }
            };
        }
    });
}
